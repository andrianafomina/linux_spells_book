# Dockerfile

Dockerfile — это текстовый файл, который содержит инструкции для создания Docker-образа.

Основные инструкции:

| Инструкция | Описание | Пример |
| --- | --- | --- |
| FROM | указывает базовый образ, с которого начинается создание | FROM ubuntu:20.04 |
| RUN | выполняет команды внутри контейнера (например, установку пакетов) | RUN apt-get update && apt-get install -y python3 |
| COPY | копирует файлы из хост-системы в контейнер. | COPY ./app /app |
| WORKDIR | задает рабочую директорию для выполнения следующих команд | WORKDIR /app |
| CMD | команда, которая будет выполнена при запуске контейнер | CMD ["python3", "[app.py](http://app.py/)"] |
| ENTRYPOINT | аналогично CMD, но принимает опции команды при запуске комнтейнера | ENTRYPOINT [”nginx”] |
| EXPOSE | указание портов, которые будут доступны при пробросе на хост | EXPOSE 80 |
| ENV | установить переменную окружения | ENV HOST localhost:8080 |

Примеры

1. простое python приложение

```python
FROM python:3.9-slim

WORKDIR /

COPY . /app

RUN pip install -r requirements.txt

CMD ["python", "app.py"]
```

1. приложение с мультистейдж

```python
# Этап 1: Сборка
FROM python:3.9-slim AS builder

WORKDIR /app
COPY . /app

# Устанавливаем зависимости
RUN pip install -r requirements.txt

# Этап 2: Финальный образ
FROM python:3.9-slim

WORKDIR /app

# Копируем только необходимые файлы из предыдущего этапа
COPY --from=builder /app /app

CMD ["python", "app.py"]
```

Мульти-стейдж сборка позволяет оптимизировать процесс создания образов, разделяя его на несколько этапов. Это полезно, например, когда нужно использовать более тяжёлые образы для сборки (например, для установки зависимостей) и более лёгкие для финального образа.