# Введение в cgroups

**Cgroups** (или **Control Groups**) — это механизм в Linux, который позволяет ограничивать, приоритизировать, учитывать и изолировать ресурсы (например, CPU, память, диск, сеть) между процессами или группами процессов. Он предоставляет удобный способ управления системными ресурсами и позволяет эффективно контролировать, какие ресурсы доступны для определённых приложений и процессов в системе.

Cgroups организуют процессы в **группы**, которые могут быть иерархически организованы. Каждый процесс в Linux может быть добавлен в одну или несколько групп, и каждая группа будет иметь свои ограничения на ресурсы. Эти группы могут быть настроены с разными политиками для использования различных ресурсов, например:

•	**CPU** — сколько процессорного времени доступно процессу.

•	**Память** — сколько памяти может использовать процесс.

•	**Диск** — сколько дискового ввода-вывода (I/O) процесс может генерировать.

•	**Сеть** — сколько пропускной способности сети может использовать процесс.

Cgroups реализуются через виртуальные файловые системы (например, cgroupfs или systemd), что позволяет операционной системе и пользователям управлять этими группами через файловую систему.

Для управления cgroups используется виртуальная файловая система, которая монтируется в систему, обычно в каталог /sys/fs/cgroup. В этом каталоге содержатся различные подсистемы, которые управляют ресурсами. Каждая подсистема имеет свой каталог, и в этих каталогах можно настроить ограничения.

Пример структуры cgroups может выглядеть так:

```bash
/sys/fs/cgroup/
    ├── cpu/
    ├── memory/
    ├── blkio/
    ├── net_cls/
    ├── pids/
```

Основные подсистемы

•	**cpu**: Ограничивает использование CPU. Вы можете задавать квоты на использование процессора, а также приоритизировать процессы.

•	**memory**: Ограничивает использование памяти для группы процессов. Если процесс превышает установленный лимит, он может быть убит системой (OOM — out of memory).

•	**blkio**: Управляет использованием ввода-вывода на диске.

•	**pids**: Ограничивает количество процессов, которые могут быть запущены в группе.

•	**net_cls**: Используется для классификации сетевых пакетов, отправляемых из контейнера или группы процессов.

**Docker** активно использует cgroups для изоляции и управления ресурсами контейнеров. Когда  запускается контейнер, Docker автоматически создает для него cgroup, чтобы ограничить доступ к ресурсам, таким как процессор, память и дисковая активность.